{% extends "base.html" %}
{% block home %}
<div class='w-full'>
    
    {% for item in form  %}       
        <ul class='my-2 p-2'>
           
            <div class='bg-slate-800  grid md:grid-cols-2 gap-2 p-2 h-full'>
                <div class='p-2 col-span-1 rounded-lg bg-black'>
                <div>
                <h3 class='font-bold text-lg text-gray-300 text-ellipsis overflow-x-scroll no-scrollbar'>{{item.title|capfirst}}</h3>
                </div>
                <video controls autoplay-off class='w-full'>
                    <source src="/media/{{item.video}}" type='video/mp4'>
                </video>
                <div class='grid grid-cols-5 text-right'>
                    <div class='col-span-1'></div>
                    <div class='col-span-1'></div>
                    <div class='col-span-1'></div>
                    <div class='col-span-1'>
                        {% if user.is_authenticated %}
                        {% if user.id in item.liked_users %}
                            <form action="{% url 'like_video' item.id %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class='text-center'><i class="fa-solid fa-heart  text-orange-600 w-6 h-6 "></i><br> you liked</button>
                            </form>
                        {% else %}
                            <form action="{% url 'like_video' item.id %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class='text-center'><i class="fa-regular fa-heart  text-orange-600 w-6 h-6 "></i><br>add like</button>
                            </form>
                        {% endif %}
                        {% else %}
                        <a href="{% url 'login' %}"><button type="submit" class='text-center'><i class="fa-regular fa-heart  text-orange-600 w-6 h-6 "></i><br>add like</button></a>
                        {% endif %}
                    </div>
                    <div class='col-span-1'>
                        {% if user.is_authenticated %}
                        {% if user.id in item.cart_users %}
                            <form action="{% url 'cart-item' item.id %}" method="post"> 
                                {% csrf_token %}  
                            <button type='submit' class=''><i class="fa-solid fa-cart-shopping w-6 h-6 font-serif 
                                items-center   text-orange-700"></i><br>Item carted</button>
                            <br>
                            </form>
                        {% else %}
                            <form action="{% url 'cart-item' item.id %}" method="post"> 
                                {% csrf_token %}  
                            <button type='submit' class=''><i class="fa-solid fa-cart-shopping w-6 h-6 font-serif 
                                items-center   text-slate-200 hover:text-slate-200"></i><br>Add Cart</button>
                            <br>
                            </form>
                        {% endif %}
                        {% else %}
                            <a href="{% url 'login' %}"><button type='submit' class=''><i class="fa-solid fa-cart-shopping w-6 h-6 font-serif 
                                items-center   text-orange-700"></i></button></a> 
                        {% endif %}
                    </div>
                </div>
                </div>
                <div class='p-2 col-span-1 overflow-y-scroll  no-scrollbar py-2'>
                <h3>Posted By : {{item.instructor.username}}</h3>
                <p>Published On : {{item.created_at}}</p>
                <p>Price: {{item.price}}</p>
                <p>Description:  {{item.description}}</p>
                <p>Likes: {{item.total_likes}}</p>
                <p>Rating: {{item.average_rating}}</p>
                <p>
                    <a href="{% url 'item-details' item.id %}"><button class='p-1 bg-blue-500 border border-blue-200 my-2' id='rate_video'>Rate This Video:</button></a>
                </p>
                <p>
                    <span class='font-bold underline text-violet-700'>Comments:-</span>
                    <ul class='p-2 h-44 overflow-y-scroll sup-scrollbar bg-gray-800 my-2 border-gray-400 rounded-lg'>
                    {% for comment in item.comments.all  %}
                            <li><span class='font-bold mr-2'>{{comment.user}}:</span>{{comment.comment}}</li>
                           
                    {% endfor %}
                    </ul>
                </p>
                <p class='text-right'>
                    <a href="{% url 'item-details' item.id %}"><button type='submit' class='bg-green-400 p-1 rounded-md'>Post Comment</button></a>
                </p>

            </div>
        </ul>  

    {% endfor %}
    
        
</div><br>
{% endblock home %}